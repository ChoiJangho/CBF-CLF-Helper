function x = zd_lift(theta1,dtheta1)
%ZD_LIFT    Lifts the zero dynamics to the full state of the system.
%
%    X = ZD_LIFT(THETA1,DTHETA1)

%Eric Westervelt
%01-May-2001 05:42:40

[a,b,m] = controlParameters;

a0=a(1); a1=a(2); a2=a(3); a3=a(4); a4=a(5); a5=a(6); a6=a(7); 
b0=a(8); b1=a(9); b2=a(10); b3=a(11); b4=a(12); b5=a(13); b6=a(14); 
c0=a(15); c1=a(16); c2=a(17); c3=a(18); c4=a(19); c5=a(20); c6=a(21); 
d0=a(22); d1=a(23); d2=a(24); d3=a(25); d4=a(26); d5=a(27); d6=a(28); 

q31 = -1./2.*c0.*(1-(theta1-b)./m).^6-3.*c1.*(theta1-b)./m.*(1-(theta1- ...
      b)./m).^5-15./2.*c2.*(theta1-b).^2./m.^2.*(1-(theta1-b)./m).^4- ...
      10.*c3.*(theta1-b).^3./m.^3.*(1-(theta1-b)./m).^3-15./2.*c4.* ...
      (theta1-b).^4./m.^4.*(1-(theta1-b)./m).^2-3.*c5.*(theta1- ...
      b).^5./m.^5.*(1-(theta1-b)./m)-1./2.*c6.*(theta1-b).^6./m.^6+ ...
      theta1;

q32 = b0.*(1-(theta1-b)./m).^6+6.*b1.*(theta1-b)./m.*(1-(theta1- ...
      b)./m).^5+15.*b2.*(theta1-b).^2./m.^2.*(1-(theta1-b)./m).^4+20.* ...
      b3.*(theta1-b).^3./m.^3.*(1-(theta1-b)./m).^3+15.*b4.*(theta1- ...
      b).^4./m.^4.*(1-(theta1-b)./m).^2+6.*b5.*(theta1-b).^5./m.^5.*(1- ...
      (theta1-b)./m)+b6.*(theta1-b).^6./m.^6-1./2.*c0.*(1-(theta1- ...
      b)./m).^6-3.*c1.*(theta1-b)./m.*(1-(theta1-b)./m).^5-15./2.*c2.* ...
      (theta1-b).^2./m.^2.*(1-(theta1-b)./m).^4-10.*c3.*(theta1- ...
      b).^3./m.^3.*(1-(theta1-b)./m).^3-15./2.*c4.*(theta1- ...
      b).^4./m.^4.*(1-(theta1-b)./m).^2-3.*c5.*(theta1-b).^5./m.^5.*(1- ...
      (theta1-b)./m)-1./2.*c6.*(theta1-b).^6./m.^6+theta1;

q41 = 1./2.*c0.*(1-(theta1-b)./m).^6+3.*c1.*(theta1-b)./m.*(1-(theta1- ...
      b)./m).^5+15./2.*c2.*(theta1-b).^2./m.^2.*(1-(theta1-b)./m).^4+ ...
      10.*c3.*(theta1-b).^3./m.^3.*(1-(theta1-b)./m).^3+15./2.*c4.* ...
      (theta1-b).^4./m.^4.*(1-(theta1-b)./m).^2+3.*c5.*(theta1- ...
      b).^5./m.^5.*(1-(theta1-b)./m)+1./2.*c6.*(theta1-b).^6./m.^6+ ...
      theta1;

q42 = b0.*(1-(theta1-b)./m).^6+6.*b1.*(theta1-b)./m.*(1-(theta1- ...
      b)./m).^5+15.*b2.*(theta1-b).^2./m.^2.*(1-(theta1-b)./m).^4+20.* ...
      b3.*(theta1-b).^3./m.^3.*(1-(theta1-b)./m).^3+15.*b4.*(theta1- ...
      b).^4./m.^4.*(1-(theta1-b)./m).^2+6.*b5.*(theta1-b).^5./m.^5.*(1- ...
      (theta1-b)./m)+b6.*(theta1-b).^6./m.^6-1./2.*c0.*(1-(theta1- ...
      b)./m).^6-3.*c1.*(theta1-b)./m.*(1-(theta1-b)./m).^5-15./2.*c2.* ...
      (theta1-b).^2./m.^2.*(1-(theta1-b)./m).^4-10.*c3.*(theta1- ...
      b).^3./m.^3.*(1-(theta1-b)./m).^3-15./2.*c4.*(theta1- ...
      b).^4./m.^4.*(1-(theta1-b)./m).^2-3.*c5.*(theta1-b).^5./m.^5.*(1- ...
      (theta1-b)./m)-1./2.*c6.*(theta1-b).^6./m.^6+d0.*(1-(theta1- ...
      b)./m).^6+6.*d1.*(theta1-b)./m.*(1-(theta1-b)./m).^5+15.*d2.* ...
      (theta1-b).^2./m.^2.*(1-(theta1-b)./m).^4+20.*d3.*(theta1- ...
      b).^3./m.^3.*(1-(theta1-b)./m).^3+15.*d4.*(theta1-b).^4./m.^4.* ...
      (1-(theta1-b)./m).^2+6.*d5.*(theta1-b).^5./m.^5.*(1-(theta1- ...
      b)./m)+d6.*(theta1-b).^6./m.^6+theta1;

q1 = a0.*(1-(theta1-b)./m).^6+6.*a1.*(theta1-b)./m.*(1-(theta1- ...
     b)./m).^5+15.*a2.*(theta1-b).^2./m.^2.*(1-(theta1-b)./m).^4+20.* ...
     a3.*(theta1-b).^3./m.^3.*(1-(theta1-b)./m).^3+15.*a4.*(theta1- ...
     b).^4./m.^4.*(1-(theta1-b)./m).^2+6.*a5.*(theta1-b).^5./m.^5.*(1- ...
     (theta1-b)./m)+a6.*(theta1-b).^6./m.^6;

dq31 = -1./2.*dtheta1.*(-6.*c0.*(1-(theta1-b)./m).^5./m+6.*c1./m.*(1- ...
       (theta1-b)./m).^5-30.*c1.*(theta1-b)./m.^2.*(1-(theta1-b)./m).^4+ ...
       30.*c2.*(theta1-b)./m.^2.*(1-(theta1-b)./m).^4-60.*c2.*(theta1- ...
       b).^2./m.^3.*(1-(theta1-b)./m).^3+60.*c3.*(theta1-b).^2./m.^3.* ...
       (1-(theta1-b)./m).^3-60.*c3.*(theta1-b).^3./m.^4.*(1-(theta1- ...
       b)./m).^2+60.*c4.*(theta1-b).^3./m.^4.*(1-(theta1-b)./m).^2-30.* ...
       c4.*(theta1-b).^4./m.^5.*(1-(theta1-b)./m)+30.*c5.*(theta1- ...
       b).^4./m.^5.*(1-(theta1-b)./m)-6.*c5.*(theta1-b).^5./m.^6+6.*c6.* ...
       (theta1-b).^5./m.^6)+dtheta1;

dq32 = dtheta1.*(-6.*b0.*(1-(theta1-b)./m).^5./m+6.*b1./m.*(1-(theta1- ...
       b)./m).^5-30.*b1.*(theta1-b)./m.^2.*(1-(theta1-b)./m).^4+30.*b2.* ...
       (theta1-b)./m.^2.*(1-(theta1-b)./m).^4-60.*b2.*(theta1- ...
       b).^2./m.^3.*(1-(theta1-b)./m).^3+60.*b3.*(theta1-b).^2./m.^3.* ...
       (1-(theta1-b)./m).^3-60.*b3.*(theta1-b).^3./m.^4.*(1-(theta1- ...
       b)./m).^2+60.*b4.*(theta1-b).^3./m.^4.*(1-(theta1-b)./m).^2-30.* ...
       b4.*(theta1-b).^4./m.^5.*(1-(theta1-b)./m)+30.*b5.*(theta1- ...
       b).^4./m.^5.*(1-(theta1-b)./m)-6.*b5.*(theta1-b).^5./m.^6+6.*b6.* ...
       (theta1-b).^5./m.^6)-1./2.*dtheta1.*(-6.*c0.*(1-(theta1- ...
       b)./m).^5./m+6.*c1./m.*(1-(theta1-b)./m).^5-30.*c1.*(theta1- ...
       b)./m.^2.*(1-(theta1-b)./m).^4+30.*c2.*(theta1-b)./m.^2.*(1- ...
       (theta1-b)./m).^4-60.*c2.*(theta1-b).^2./m.^3.*(1-(theta1- ...
       b)./m).^3+60.*c3.*(theta1-b).^2./m.^3.*(1-(theta1-b)./m).^3-60.* ...
       c3.*(theta1-b).^3./m.^4.*(1-(theta1-b)./m).^2+60.*c4.*(theta1- ...
       b).^3./m.^4.*(1-(theta1-b)./m).^2-30.*c4.*(theta1-b).^4./m.^5.* ...
       (1-(theta1-b)./m)+30.*c5.*(theta1-b).^4./m.^5.*(1-(theta1-b)./m)- ...
       6.*c5.*(theta1-b).^5./m.^6+6.*c6.*(theta1-b).^5./m.^6)+dtheta1;

dq41 = 1./2.*dtheta1.*(-6.*c0.*(1-(theta1-b)./m).^5./m+6.*c1./m.*(1- ...
       (theta1-b)./m).^5-30.*c1.*(theta1-b)./m.^2.*(1-(theta1-b)./m).^4+ ...
       30.*c2.*(theta1-b)./m.^2.*(1-(theta1-b)./m).^4-60.*c2.*(theta1- ...
       b).^2./m.^3.*(1-(theta1-b)./m).^3+60.*c3.*(theta1-b).^2./m.^3.* ...
       (1-(theta1-b)./m).^3-60.*c3.*(theta1-b).^3./m.^4.*(1-(theta1- ...
       b)./m).^2+60.*c4.*(theta1-b).^3./m.^4.*(1-(theta1-b)./m).^2-30.* ...
       c4.*(theta1-b).^4./m.^5.*(1-(theta1-b)./m)+30.*c5.*(theta1- ...
       b).^4./m.^5.*(1-(theta1-b)./m)-6.*c5.*(theta1-b).^5./m.^6+6.*c6.* ...
       (theta1-b).^5./m.^6)+dtheta1;

dq42 = dtheta1.*(-6.*b0.*(1-(theta1-b)./m).^5./m+6.*b1./m.*(1-(theta1- ...
       b)./m).^5-30.*b1.*(theta1-b)./m.^2.*(1-(theta1-b)./m).^4+30.*b2.* ...
       (theta1-b)./m.^2.*(1-(theta1-b)./m).^4-60.*b2.*(theta1- ...
       b).^2./m.^3.*(1-(theta1-b)./m).^3+60.*b3.*(theta1-b).^2./m.^3.* ...
       (1-(theta1-b)./m).^3-60.*b3.*(theta1-b).^3./m.^4.*(1-(theta1- ...
       b)./m).^2+60.*b4.*(theta1-b).^3./m.^4.*(1-(theta1-b)./m).^2-30.* ...
       b4.*(theta1-b).^4./m.^5.*(1-(theta1-b)./m)+30.*b5.*(theta1- ...
       b).^4./m.^5.*(1-(theta1-b)./m)-6.*b5.*(theta1-b).^5./m.^6+6.*b6.* ...
       (theta1-b).^5./m.^6)-1./2.*dtheta1.*(-6.*c0.*(1-(theta1- ...
       b)./m).^5./m+6.*c1./m.*(1-(theta1-b)./m).^5-30.*c1.*(theta1- ...
       b)./m.^2.*(1-(theta1-b)./m).^4+30.*c2.*(theta1-b)./m.^2.*(1- ...
       (theta1-b)./m).^4-60.*c2.*(theta1-b).^2./m.^3.*(1-(theta1- ...
       b)./m).^3+60.*c3.*(theta1-b).^2./m.^3.*(1-(theta1-b)./m).^3-60.* ...
       c3.*(theta1-b).^3./m.^4.*(1-(theta1-b)./m).^2+60.*c4.*(theta1- ...
       b).^3./m.^4.*(1-(theta1-b)./m).^2-30.*c4.*(theta1-b).^4./m.^5.* ...
       (1-(theta1-b)./m)+30.*c5.*(theta1-b).^4./m.^5.*(1-(theta1-b)./m)- ...
       6.*c5.*(theta1-b).^5./m.^6+6.*c6.*(theta1-b).^5./m.^6)+dtheta1.* ...
       (-6.*d0.*(1-(theta1-b)./m).^5./m+6.*d1./m.*(1-(theta1-b)./m).^5- ...
       30.*d1.*(theta1-b)./m.^2.*(1-(theta1-b)./m).^4+30.*d2.*(theta1- ...
       b)./m.^2.*(1-(theta1-b)./m).^4-60.*d2.*(theta1-b).^2./m.^3.*(1- ...
       (theta1-b)./m).^3+60.*d3.*(theta1-b).^2./m.^3.*(1-(theta1- ...
       b)./m).^3-60.*d3.*(theta1-b).^3./m.^4.*(1-(theta1-b)./m).^2+60.* ...
       d4.*(theta1-b).^3./m.^4.*(1-(theta1-b)./m).^2-30.*d4.*(theta1- ...
       b).^4./m.^5.*(1-(theta1-b)./m)+30.*d5.*(theta1-b).^4./m.^5.*(1- ...
       (theta1-b)./m)-6.*d5.*(theta1-b).^5./m.^6+6.*d6.*(theta1- ...
       b).^5./m.^6)+dtheta1;

dq1 = dtheta1.*(-6.*a0.*(1-(theta1-b)./m).^5./m+6.*a1./m.*(1-(theta1- ...
      b)./m).^5-30.*a1.*(theta1-b)./m.^2.*(1-(theta1-b)./m).^4+30.*a2.* ...
      (theta1-b)./m.^2.*(1-(theta1-b)./m).^4-60.*a2.*(theta1- ...
      b).^2./m.^3.*(1-(theta1-b)./m).^3+60.*a3.*(theta1-b).^2./m.^3.* ...
      (1-(theta1-b)./m).^3-60.*a3.*(theta1-b).^3./m.^4.*(1-(theta1- ...
      b)./m).^2+60.*a4.*(theta1-b).^3./m.^4.*(1-(theta1-b)./m).^2-30.* ...
      a4.*(theta1-b).^4./m.^5.*(1-(theta1-b)./m)+30.*a5.*(theta1- ...
      b).^4./m.^5.*(1-(theta1-b)./m)-6.*a5.*(theta1-b).^5./m.^6+6.*a6.* ...
      (theta1-b).^5./m.^6);

x = [q31; q32; q41; q42; q1; dq31; dq32; dq41; dq42; dq1];