function [a,b,m,dtheta_fixed] = controlParameters
%CONTROLPARAMETERS Control parameters for the biped robot.

%Eric Westervelt
%2/15/01

global WHICH_TO_TWEAK TWEAK_AMOUNT WHICH_PARAM

if isempty(WHICH_PARAM)
  the_param = 4;
else
  the_param = WHICH_PARAM;
end

the_param=3;
switch the_param
 case 1
  % bezier fit to 100 (.75 m/s)
  dtheta_fixed = -1.5258;
  m = -0.58887;
  b = 3.4301;
 
  aa = [-0.10423; -0.20055; -0.42545; 
	0.048042; -0.12654; -0.088101; -0.10423];
  bb = [-0.62361; -0.85665; -0.73188;
	-0.036404; 0.66029; 0.63419; 0.62361];
  cc = [-0.24094; -0.57179; -1.072;
	0.062835; -0.58463; -0.3823; -0.17162];
  dd = [-0.17154; -0.034859; -0.77177; 
	-0.891; -1.7761; -0.89056; -0.24118];
 case 2
  %bezier fit to 101 (.85 m/s)
  dtheta_fixed = -1.4428;
  m = -0.58266;
  b = 3.4285;
 
  aa = [-0.14539; -0.26383; -0.36871; 
	-0.25771; -0.14864; -0.10767; -0.14539];
  bb = [-0.60976; -0.88454; -0.50656;
	0.19492; 0.4895; 0.5605; 0.60976];
  cc = [-0.22406; -0.77502; -0.76833;
	-0.27294; -0.33635; -0.2637; -0.16984];
  dd = [-0.16984; -0.18134; -0.62412;
	-0.85509; -1.0363; -0.61177; -0.22405];
 case 3
  %bezier fit to 102 (.95 m/s)
  dtheta_fixed = -1.48705;
  m = -0.57723;
  b = 3.4262;
 
  aa = [-0.17964; -0.28762; -0.33553;
	-0.44108; -0.1499; -0.14084; -0.17964];
  bb = [-0.5985; -0.89184; -0.52133; 
	0.098126; 0.57312; 0.51468; 0.5985];
  cc = [-0.24245; -0.86505; -0.76354;
	-0.55554; -0.12597; -0.24617; -0.19992];
  dd = [-0.19992; -0.24989; -0.88613;
	-0.98059; -1.1521; -0.42793; -0.24246];
 case 4
  % fit to data_Franck2
  m = -0.64749;
  b = 3.4653;
  dtheta_fixed = -1.5;
  aa = [0.10472; 0.086861; 0.12981; 0.084472; 0.11453; 0.10238; 0.10472];
  bb = [-0.64749; -0.99933; 0.42886; -0.35741; 0.42343; 0.43529; 0.64749];
  cc = [-0.37703; -0.70174; -0.43974; -0.878; -0.52211; -0.63045; -0.37703];
  dd = [-0.37703; -0.035692; -1.4708; -0.23464; -0.93472; -0.62639; -0.37703];
 case 100
  % best from 0019
  % peak torque 34.489 Nm ! (from 0019, #601)
  % design rate = .75 m/s
  % actual rate fd = .75586 m/s
  % dtheta_fixed_fd = -1.5259
  % dtheta_fixed_zd = -1.5259
  
  dtheta_fixed = -1.5259;
  
  %dtheta = -1.5244;
  m = -0.5889;
  b = 3.4301;
  aa = [-0.104231; -0.200629; -0.425354;
        0.048028; -0.126524; -0.088105; -0.104231];
  bb = [-0.023751; -0.414821; -0.794973;
        -1.050018; -0.287156; -0.048590; -0.023751];
  cc = [2.900650; 2.569582; 2.069861;
        3.204332; 2.556976; 2.759304; 2.970050];
  dd = [2.970050; 3.106941; 2.369179;
        2.251128; 1.364924; 2.251402; 2.900650];
 
 case 101
  % best from 0005
  % peak torque 39.422 Nm ! (from 0005, #4475)
  % design rate = .85 m/s
  % actual rate fd = .85021 m/s
  % dtheta_fixed_fd = -1.4430
  % dtheta_fixed_zd = -1.4431
  
  dtheta_fixed = -1.4430;
  
  %dtheta = -1.4429;
  m = -0.5827;
  b = 3.4285;
  aa = [-0.145395; -0.263783; -0.368703;
        -0.257797; -0.148614; -0.107673; -0.145395];
  bb = [-0.017859; -0.416229; -0.498426;
        -0.210251; -0.127241; -0.021835; -0.017859];
  cc = [2.917536; 2.366868; 2.372859;
        2.868797; 2.805203; 2.877889; 2.971748];
  dd = [2.971748; 2.960407; 2.517592;
        2.286506; 2.105212; 2.529779; 2.917536];
 case 102
  % best from 0021
  % peak torque 42.23 Nm ! (from 0020, #2035)
  % design rate = .95 m/s
  % actual rate fd = .9497 m/s
  % dtheta_fixed_fd = -1.48705
  % dtheta_fixed_zd = -1.48705
  
  dtheta_fixed = -1.48705;
  
  %dtheta = -1.4873;
  m = -0.5772;
  b = 3.4262;
  aa = [-0.179641; -0.287638; -0.335568;
        -0.441010; -0.149923; -0.140826; -0.179641];
  bb = [-0.015911; -0.414943; -0.796324;
        -0.244587; -0.280635;  0.062087; -0.015911];
  cc = [2.899138; 2.276354; 2.378248;
        2.586051; 3.015630; 2.895427; 2.941676];
  dd = [2.941676; 2.891617; 2.255246;
        2.161191; 1.989449; 2.713727; 2.899138];
 
 case 100102 % transition from 100 to 102
  m = -0.58111;
  b = 3.4301;
 
  aa = [-0.10423; -0.19935; -0.38046; -0.19649; 
        -0.13822; -0.14056; -0.17964];
  bb = [-0.023751; -0.40965; -0.79565; -0.6473; 
        -0.2839; 0.062615; -0.015911];
  cc = [2.9007; 2.574; 2.2241; 2.8952; 
        2.7863; 2.8951; 2.9417];
  dd = [2.9701; 3.1051; 2.3122; 2.2062; 
        1.6772; 2.7125; 2.8991];
end
a = [aa; bb; cc; dd];

% for calculating initial control sensitivities
if ~isempty(WHICH_TO_TWEAK)
  if WHICH_TO_TWEAK ~= 0
    if abs(a(WHICH_TO_TWEAK + 4)) < .01
      a(WHICH_TO_TWEAK + 4) = a(WHICH_TO_TWEAK + 4) + (TWEAK_AMOUNT - 1);
    else
      a(WHICH_TO_TWEAK + 4) = a(WHICH_TO_TWEAK + 4)*TWEAK_AMOUNT;
    end
  end
end